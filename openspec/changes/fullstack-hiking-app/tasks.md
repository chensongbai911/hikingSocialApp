# Implementation Tasks: 徒步社交 App 全栈开发

## Phase 1: 项目初始化与规划 (Day 1-2)

### 1.1 前端项目初始化

- [ ] 使用 Vite 创建 Vue 3 + TypeScript 项目
- [ ] 安装核心依赖 (Vue Router, Pinia, Axios, Tailwind CSS)
- [ ] 配置 Lynx 跨端支持 (安装和配置编译器)
- [ ] 设置 ESLint 和 Prettier
- [ ] 创建项目目录结构 (components, stores, api, utils, styles)
- [ ] 配置 Tailwind CSS 和全局样式变量
- [ ] 创建 .env.example 环境变量配置

### 1.2 后端项目初始化

- [ ] 初始化 Node.js + Express 项目
- [ ] 安装核心依赖 (Express, Sequelize/TypeORM, JWT, Bcrypt, Joi)
- [ ] 设置 TypeScript 配置
- [ ] 配置 Winston 日志系统
- [ ] 创建后端目录结构 (controllers, services, models, routes, middleware)
- [ ] 设置 .env 环境变量
- [ ] 配置 Jest 测试框架

### 1.3 数据库设计与初始化

- [ ] 设计完整的数据库 ER 图
- [ ] 编写 MySQL 初始化脚本 (创建所有表)
- [ ] 设计数据库迁移文件
- [ ] 创建初始化种子数据脚本
- [ ] 配置 Sequelize/TypeORM 模型定义
- [ ] 测试数据库连接

### 1.4 项目文档编写

- [ ] 编写前端 README.md (安装、开发、构建步骤)
- [ ] 编写后端 README.md
- [ ] 创建 API 文档骨架 (Swagger/OpenAPI 格式)
- [ ] 编写贡献指南 (CONTRIBUTING.md)

---

## Phase 2: 后端核心功能开发 (Day 3-4)

### 2.1 认证系统

- [ ] 实现 User 模型和迁移
- [ ] 编写 authService (注册、登录逻辑)
- [ ] 实现密码加密 (Bcrypt)
- [ ] 实现 JWT Token 生成和验证
- [ ] 编写 authMiddleware (token 验证)
- [ ] 编写 authController
- [ ] 编写 authRoutes
- [ ] 编写认证单元测试
- [ ] 测试注册、登录、token 刷新流程

### 2.2 用户管理功能

- [ ] 创建 UserPreference 和 UserPhoto 模型
- [ ] 实现 userService (CRUD、验证、业务逻辑)
- [ ] 实现文件上传处理 (fileService, 头像和相册照片)
- [ ] 编写 userController (所有用户相关接口)
- [ ] 编写 userRoutes
- [ ] 实现用户信息检索和过滤
- [ ] 编写用户管理单元测试

### 2.3 活动管理功能

- [ ] 创建 Activity 和 Participation 模型
- [ ] 实现 activityService (创建、编辑、删除、查询)
- [ ] 实现活动状态流转逻辑
- [ ] 编写 activityController
- [ ] 编写 activityRoutes 和 participationRoutes
- [ ] 实现分页、排序、过滤
- [ ] 编写活动管理单元测试

### 2.4 发现与搜索功能

- [ ] 实现 matchingService (推荐算法基础)
- [ ] 编写 discoveryController (用户搜索、筛选)
- [ ] 编写 discoveryRoutes
- [ ] 实现多条件筛选逻辑 (性别、年龄、等级、偏好)
- [ ] 编写发现功能单元测试

### 2.5 错误处理与日志

- [ ] 实现全局错误处理中间件
- [ ] 编写自定义错误类
- [ ] 配置 Winston 日志记录
- [ ] 添加请求日志记录
- [ ] 实现统一的 API 响应格式

### 2.6 API 文档完善

- [ ] 编写所有接口的 Swagger 文档
- [ ] 生成 API 文档网页
- [ ] 准备 Postman 集合文件

---

## Phase 3: 前端页面开发 (Day 5-6)

### 3.1 基础组件与状态管理

- [ ] 创建 TabBar 底部导航组件
- [ ] 创建 TopBar 顶部导航组件
- [ ] 创建 ActivityCard 活动卡片组件
- [ ] 创建 UserCard 用户卡片组件
- [ ] 创建通用的 Modal、Loading、Toast 组件
- [ ] 初始化 Pinia stores (user, activities, discovery, auth)
- [ ] 配置 Vue Router 路由
- [ ] 实现页面加载动画和骨架屏

### 3.2 认证相关页面

- [ ] 开发 Login.vue 页面
  - [ ] 邮箱/密码输入
  - [ ] 登录表单验证
  - [ ] 错误提示
- [ ] 开发 Register.vue 页面
  - [ ] 注册表单 (邮箱、密码、昵称等)
  - [ ] 表单验证
  - [ ] 密码强度检查
- [ ] 实现 authStore (登录、注册、登出 actions)
- [ ] 集成 API 调用
- [ ] 测试认证流程

### 3.3 个人资料页面

- [ ] 开发 Profile.vue (我的页面)
  - [ ] 头像展示和编辑入口
  - [ ] 基本信息展示 (昵称、年龄、性别)
  - [ ] 关于我文本显示
  - [ ] 徒步偏好标签展示
  - [ ] 生活相册九宫格展示
  - [ ] 编辑资料按钮
- [ ] 开发 EditProfile.vue
  - [ ] 基本信息编辑表单
  - [ ] 关于我文本编辑 (200 字限制)
  - [ ] 徒步偏好标签编辑 (多选)
- [ ] 开发头像编辑功能 (AvatarEditScreen.vue)
  - [ ] 图片上传和裁剪
  - [ ] 预览和保存
- [ ] 开发相册管理功能
  - [ ] 上传照片
  - [ ] 删除照片
  - [ ] 最多 9 张限制
- [ ] 实现 userStore actions (更新头像、更新资料、管理相册)
- [ ] 集成用户 API

### 3.4 我的徒步页面

- [ ] 开发 MyHiking.vue
  - [ ] 顶部 Tab 切换 (我加入的/我发布的)
  - [ ] 活动卡片列表
  - [ ] 下拉刷新、加载更多
- [ ] 开发 Tab 1: 我加入的
  - [ ] 显示活动卡片 (状态标签、标题、时间、地点)
  - [ ] 点击进入详情页
- [ ] 开发 Tab 2: 我发布的
  - [ ] 显示发布的活动
  - [ ] 显示状态角标 (待审核、进行中、已结束)
  - [ ] 显示报名人数
  - [ ] 编辑和取消按钮
- [ ] 实现 activityStore (获取活动列表、删除、编辑)
- [ ] 集成活动 API

### 3.5 发现页面

- [ ] 开发 Discover.vue
  - [ ] 搜索框 (placeholder: 搜索昵称或共同兴趣)
  - [ ] 用户卡片瀑布流
  - [ ] 筛选按钮
- [ ] 开发 UserCard 组件
  - [ ] 用户头像、昵称、性别、年龄
  - [ ] 徒步等级
  - [ ] 最近活动摘要
- [ ] 开发 Filter.vue 筛选组件
  - [ ] 性别筛选 (男/女/其他)
  - [ ] 年龄区间筛选
  - [ ] 徒步等级筛选
  - [ ] 活动偏好多选 (周末、强度等)
  - [ ] 重置和应用按钮
- [ ] 实现 discoveryStore
- [ ] 集成搜索和筛选 API

### 3.6 活动管理页面

- [ ] 开发 ActivityDetail.vue
  - [ ] 显示活动基本信息 (标题、时间、地点、难度)
  - [ ] 显示活动描述
  - [ ] 显示参与人数
  - [ ] 显示路线地图
  - [ ] 参加/取消按钮 (根据状态)
- [ ] 开发 CreateActivity.vue
  - [ ] 活动表单 (标题、描述、时间、地点)
  - [ ] cover 图上传
  - [ ] 地点选择 (MapScreen 集成)
  - [ ] 表单验证
  - [ ] 发布按钮
- [ ] 开发 MapScreen.vue (地图选择)
  - [ ] 地图组件集成
  - [ ] 地址搜索和选择
  - [ ] 确认选择
- [ ] 实现活动 CRUD actions
- [ ] 集成活动 API

### 3.7 其他页面

- [ ] 开发 Home.vue (首页 - 简化版，占位)
- [ ] 开发 Messages.vue (消息页 - 占位)
- [ ] 实现页面加载状态
- [ ] 实现错误处理页面

### 3.8 前端集成与优化

- [ ] 配置 Axios 拦截器 (token 注入、错误处理)
- [ ] 实现图片懒加载
- [ ] 实现页面加载动画
- [ ] 实现错误提示 (Toast)
- [ ] 实现响应式设计 (移动端优化)
- [ ] 添加 Lynx 跨端适配代码

---

## Phase 4: 集成测试与部署 (Day 7)

### 4.1 前端测试

- [ ] 编写关键页面的单元测试 (Login, Profile, MyHiking)
- [ ] 编写关键组件的单元测试 (TabBar, ActivityCard)
- [ ] 编写 API 集成测试
- [ ] 编写 Pinia stores 测试
- [ ] 性能测试 (Lighthouse)
- [ ] 运行所有测试

### 4.2 后端测试

- [ ] 编写完整的端到端 API 测试
- [ ] 测试认证流程 (注册 → 登录 →token 验证)
- [ ] 测试用户操作流程 (更新资料、上传头像)
- [ ] 测试活动流程 (创建 → 发布 → 参加 → 完成)
- [ ] 测试发现和搜索功能
- [ ] 测试错误处理和边界条件
- [ ] 运行所有测试，确保覆盖率 >50%

### 4.3 前后端集成测试

- [ ] 在完整的前后端环境中测试所有功能
- [ ] 测试网络延迟和超时处理
- [ ] 测试并发请求
- [ ] 测试离线功能 (如有缓存)
- [ ] 修复集成问题

### 4.4 性能优化

- [ ] 前端: 优化组件渲染性能
- [ ] 前端: 优化网络请求 (缓存、合并请求)
- [ ] 前端: 压缩资源 (图片、CSS、JS)
- [ ] 后端: 数据库查询优化 (添加适当的索引)
- [ ] 后端: 实现缓存策略 (如需)
- [ ] 后端: 优化文件上传处理

### 4.5 安全检查

- [ ] 前端: 检查 XSS 漏洞
- [ ] 前端: 检查 CSRF 防护
- [ ] 后端: 检查 SQL 注入风险
- [ ] 后端: 检查认证授权
- [ ] 后端: 检查 API 限流
- [ ] 检查敏感信息泄露 (如密钥)

### 4.6 文档完善

- [ ] 完善 API 文档 (所有接口、参数、响应示例)
- [ ] 编写前端开发指南
- [ ] 编写后端开发指南
- [ ] 编写数据库维护文档
- [ ] 编写部署指南
- [ ] 编写故障排查文档

### 4.7 部署准备

- [ ] 创建 Docker 镜像 (前端和后端)
- [ ] 创建 docker-compose 文件
- [ ] 编写部署脚本
- [ ] 配置生产环境变量
- [ ] 准备数据库初始化脚本
- [ ] 测试打包和部署流程

### 4.8 最终验收

- [ ] 功能测试清单完成
- [ ] 性能指标达标
- [ ] 所有单元测试通过
- [ ] API 文档完整
- [ ] 代码审查完毕
- [ ] 准备上线

---

## 跨阶段任务

### 代码质量

- [ ] 定期代码审查
- [ ] 保持代码一致性 (ESLint, Prettier)
- [ ] 编写清晰的注释
- [ ] 遵循设计文档

### 沟通与跟踪

- [ ] 每日进度更新
- [ ] 问题及时反馈
- [ ] 需求变更评估
- [ ] 风险预警

### Git 工作流

- [ ] 创建 feature 分支
- [ ] 定期提交 commit
- [ ] 写清晰的 commit message
- [ ] 完成后创建 Pull Request

---

## 验收标准

每个 Task 完成时需要满足：

1. ✅ 代码已编写完成
2. ✅ 相关单元测试已通过
3. ✅ 代码审查已完成
4. ✅ 相关文档已更新
5. ✅ 已集成到主分支
