import{k as U,J as B,d as M,r as v,l as P,v as a,q as n,z as e,L as u,M as b,U as H,A as g,x as f,O as x,P as y,y as L}from"./vue-Eb8ZdQV1.js";import{u as S,_ as j}from"./index-BQQdwWu-.js";import"./state-WzMdx_T8.js";const D={class:"edit-profile-page"},E={class:"px-4 py-6 pb-20"},T={class:"flex flex-col items-center mb-6"},$={class:"relative mb-2"},A=["src"],N={class:"bg-white rounded-2xl shadow-sm p-5 mb-4"},q={class:"grid grid-cols-2 gap-4 mb-4"},F={class:"bg-white rounded-2xl shadow-sm p-5"},I={class:"bg-white rounded-2xl shadow-sm p-5"},J={class:"bg-white rounded-2xl shadow-sm p-5 mb-4"},O={class:"flex items-center justify-between mb-3"},R={class:"text-sm text-gray-400"},G={class:"bg-white rounded-2xl shadow-sm p-5 mb-4"},K={key:0,class:"flex flex-wrap gap-2 mb-4"},Q=["onClick"],W={key:1,class:"mt-4 pt-4 border-t border-gray-100"},X={class:"flex flex-wrap gap-2"},Y=["onClick","disabled"],Z=U({__name:"EditProfile",setup(ee){const m=B(),i=S(),r=M(()=>i.currentUser),s=v({nickname:"",gender:"other",age:void 0,bio:"",avatar_url:"",preferences:[]}),c=v(!1),h=v(["高难度爬升","重装露营","单身交友","风景摄影","周末出发","休闲徒步","宠物友好","5-10km","10-20km","20km+","爱看风景","挑战自我","团队协作","户外烹饪"]),w=()=>{m.back()},k=()=>{console.log("上传头像")},_=o=>{s.value.preferences.includes(o)||s.value.preferences.push(o)},C=o=>{s.value.preferences.splice(o,1)},p=async()=>{try{const o={nickname:s.value.nickname,gender:s.value.gender,age:s.value.age,bio:s.value.bio,avatar_url:s.value.avatar_url};await i.updateProfile(o)?(console.log("保存资料成功"),m.back()):console.error("保存资料失败:",i.error)}catch(o){console.error("保存资料失败:",o)}},V=async()=>{try{r.value||await i.fetchCurrentUser(),r.value&&(s.value={nickname:r.value.nickname,gender:r.value.gender,age:r.value.age,bio:r.value.bio||"",avatar_url:r.value.avatar_url||"",preferences:[]}),console.log("用户资料加载成功")}catch(o){console.error("加载用户资料失败:",o)}};return P(()=>{V()}),(o,t)=>(n(),a("div",D,[e("div",{class:"sticky top-0 z-10 bg-white border-b border-gray-200"},[e("div",{class:"flex items-center justify-between px-4 py-4"},[e("button",{onClick:w,class:"p-2"},[...t[5]||(t[5]=[e("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})],-1)])]),t[6]||(t[6]=e("h1",{class:"text-xl font-bold text-gray-800"},"编辑资料",-1)),e("button",{onClick:p,class:"text-teal-500 font-semibold"}," 保存 ")])]),e("div",E,[e("div",T,[e("div",$,[e("img",{src:s.value.avatar_url||"https://via.placeholder.com/112",alt:"avatar",class:"w-28 h-28 rounded-full object-cover border-4 border-white shadow-lg"},null,8,A),e("button",{onClick:k,class:"absolute bottom-0 right-0 w-10 h-10 bg-teal-500 rounded-full flex items-center justify-center border-4 border-white hover:bg-teal-600 transition-colors"},[...t[7]||(t[7]=[e("svg",{class:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M3 4V1h2v3h3v2H5v3H3V6H0V4h3zm3 6V7h3V4h7l1.83 2H21c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V10h3zm7 9c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-3.2-5c0 1.77 1.43 3.2 3.2 3.2s3.2-1.43 3.2-3.2-1.43-3.2-3.2-3.2-3.2 1.43-3.2 3.2z"})],-1)])])]),t[8]||(t[8]=e("p",{class:"text-sm text-gray-500"},"点击修改头像",-1))]),e("div",N,[t[9]||(t[9]=e("label",{class:"block text-sm font-semibold text-gray-500 mb-3"},"昵称",-1)),u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.nickname=l),type:"text",placeholder:"请输入昵称",class:"w-full px-4 py-3 bg-gray-50 rounded-xl border-0 focus:ring-2 focus:ring-teal-500 outline-none text-gray-800"},null,512),[[b,s.value.nickname]])]),e("div",q,[e("div",F,[t[11]||(t[11]=e("label",{class:"block text-sm font-semibold text-gray-500 mb-3"},"性别",-1)),u(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.gender=l),class:"w-full px-4 py-3 bg-gray-50 rounded-xl border-0 focus:ring-2 focus:ring-teal-500 outline-none text-gray-800"},[...t[10]||(t[10]=[e("option",{value:"male"},"男",-1),e("option",{value:"female"},"女",-1),e("option",{value:"other"},"其他",-1)])],512),[[H,s.value.gender]])]),e("div",I,[t[12]||(t[12]=e("label",{class:"block text-sm font-semibold text-gray-500 mb-3"},"年龄",-1)),u(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.value.age=l),type:"number",placeholder:"请输入年龄",class:"w-full px-4 py-3 bg-gray-50 rounded-xl border-0 focus:ring-2 focus:ring-teal-500 outline-none text-gray-800"},null,512),[[b,s.value.age,void 0,{number:!0}]])])]),e("div",J,[e("div",O,[t[13]||(t[13]=e("label",{class:"text-sm font-semibold text-gray-500"},"关于我",-1)),e("span",R,g(s.value.bio.length)+"/100",1)]),u(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=l=>s.value.bio=l),placeholder:"介绍一下自己吧...",maxlength:"100",rows:"4",class:"w-full px-4 py-3 bg-gray-50 rounded-xl border-0 focus:ring-2 focus:ring-teal-500 outline-none text-gray-800 resize-none"},null,512),[[b,s.value.bio]])]),e("div",G,[t[17]||(t[17]=e("label",{class:"block text-sm font-semibold text-gray-500 mb-3"},"徒步偏好",-1)),s.value.preferences.length>0?(n(),a("div",K,[(n(!0),a(x,null,y(s.value.preferences,(l,d)=>(n(),a("div",{key:d,class:"flex items-center gap-2 px-4 py-2 bg-teal-50 text-teal-600 rounded-full text-sm font-medium"},[e("span",null,g(l),1),e("button",{onClick:z=>C(d),class:"hover:text-teal-800"},[...t[14]||(t[14]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)])],8,Q)]))),128))])):f("",!0),e("button",{onClick:t[4]||(t[4]=l=>c.value=!c.value),class:"flex items-center gap-2 px-4 py-2 border-2 border-dashed border-teal-300 text-teal-500 rounded-full text-sm font-medium hover:bg-teal-50 transition-colors"},[...t[15]||(t[15]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})],-1),e("span",null,"添加偏好",-1)])]),c.value?(n(),a("div",W,[t[16]||(t[16]=e("p",{class:"text-sm text-gray-500 mb-3"},"推荐标签",-1)),e("div",X,[(n(!0),a(x,null,y(h.value,(l,d)=>(n(),a("button",{key:d,onClick:z=>_(l),disabled:s.value.preferences.includes(l),class:L(["px-4 py-2 rounded-full text-sm font-medium transition-colors",s.value.preferences.includes(l)?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-600 hover:bg-teal-50 hover:text-teal-600"])},g(l),11,Y))),128))])])):f("",!0)]),e("button",{onClick:p,class:"w-full py-4 bg-teal-500 text-white rounded-2xl font-semibold text-lg hover:bg-teal-600 transition-colors shadow-sm"}," 保存修改 ")])]))}}),oe=j(Z,[["__scopeId","data-v-b13e547d"]]);export{oe as default};
