import{k as q,J as E,E as F,r as w,d as y,l as J,F as P,v as l,q as n,z as t,x as d,y as h,O as x,P as m,s as S,u as M,N as k,S as R,K as f,A as a}from"./vue-Dq4PaVdn.js";import{u as K}from"./activity-C3QKEKOI.js";import{u as O,t as D,_ as U}from"./index-BMqTMtsc.js";import"./state-COm4LJOs.js";import"./activity-D_MuFah0.js";const G={class:"my-hiking-page"},Q={class:"sticky top-0 z-10 bg-white border-b border-gray-200 shadow-sm"},W={class:"flex gap-0 border-b border-gray-200"},X={key:0,class:"absolute bottom-0 left-0 right-0 h-1 bg-teal-500 rounded-t-sm"},Y={key:0,class:"absolute bottom-0 left-0 right-0 h-1 bg-teal-500 rounded-t-sm"},Z={class:"px-4 py-4 pb-20"},tt={key:0},et={key:0,class:"space-y-4"},st=["onClick"],ot={class:"relative overflow-hidden h-56"},lt=["src","alt"],nt={class:"absolute top-4 left-4"},rt={class:"p-4"},at={class:"font-bold text-lg text-gray-800 mb-3"},it={class:"space-y-2 mb-4 text-sm text-gray-600"},dt={class:"flex items-center gap-2"},ct={class:"flex items-center gap-2"},ut={key:0,class:"flex items-center gap-2 py-3 border-t border-gray-100"},pt={class:"flex -space-x-2"},gt=["src","alt","title"],xt={key:0,class:"w-8 h-8 rounded-full border-2 border-white bg-teal-100 flex items-center justify-center text-xs font-semibold text-teal-600"},mt={class:"text-sm text-gray-600 ml-2"},ft={key:1,class:"text-center py-16"},bt={key:1},vt={key:0,class:"space-y-4"},ht=["onClick"],_t=["src","alt"],wt={class:"absolute top-4 right-4"},yt={class:"absolute top-4 left-4"},kt={class:"inline-block text-xs font-bold px-3 py-1 rounded-full bg-yellow-500 text-white"},Ct={class:"p-4"},jt=["onClick"],$t={class:"space-y-2 mb-4 text-sm text-gray-600"},zt={class:"flex items-center gap-2"},At={class:"flex items-center gap-2"},St={key:0,class:"mb-4 p-3 bg-teal-50 rounded-xl border border-teal-200"},Mt={class:"flex items-center justify-between gap-2"},Dt={class:"flex items-center gap-2 flex-1 min-w-0"},Bt={class:"flex -space-x-2 flex-shrink-0"},Tt=["src","alt","title"],Nt={class:"text-sm font-semibold text-gray-700 whitespace-nowrap"},Ht={class:"text-teal-600"},Vt=["onClick"],It={key:1,class:"mb-4 p-3 bg-orange-50 rounded-xl border border-orange-200"},Lt={class:"flex items-center justify-between gap-2"},qt={class:"flex items-center gap-2 flex-1 min-w-0"},Et={class:"flex -space-x-2 flex-shrink-0"},Ft=["src","alt","title"],Jt={class:"text-sm font-semibold text-gray-700"},Pt=["onClick"],Rt={class:"flex gap-2 pt-3 border-t border-gray-100"},Kt=["onClick"],Ot=["onClick"],Ut={key:1,class:"text-center py-16"},Gt={class:"flex gap-3"},Qt=q({__name:"MyHiking",setup(Wt){const b=E(),B=F(),p=K();O();const i=w("joined");y(()=>p.loading);const g=w(!1),v=w(null),T=o=>{const e=new Date,c=new Date(o.start_time),s=o.end_time?new Date(o.end_time):null;return o.status==="cancelled"?"å·²å–æ¶ˆ":o.status==="completed"||s&&e>s?"å·²å®Œæˆ":e>=c&&(!s||e<=s)?"è¿›è¡Œä¸­":e<c?"å¾…å‚åŠ ":o.status==="recruiting"?"æ‹›å‹Ÿä¸­":"å·²å®Œæˆ"},C=o=>({id:o.id,title:o.title,location:o.location,startTime:o.start_time,coverImage:o.cover_image_url||"https://images.unsplash.com/photo-1551632811-561732d1e306?w=800&h=400&fit=crop",status:T(o),difficulty:o.difficulty||"easy",participantCount:o.participant_count||0,participants:[],applicants:[]}),j=y(()=>p.joinedActivities.map(C)),$=y(()=>p.createdActivities.map(C));J(async()=>{B.query.tab==="created"&&(i.value="created"),await z()});const z=async()=>{try{await Promise.all([p.fetchMyJoinedActivities({page:1,page_size:20}),p.fetchMyCreatedActivities({page:1,page_size:20})]),console.log("æ´»åŠ¨åˆ—è¡¨åŠ è½½æˆåŠŸ")}catch(o){console.error("åŠ è½½æ´»åŠ¨åˆ—è¡¨å¤±è´¥:",o)}},A=o=>{if(!o)return"";try{const e=new Date(o),c=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),r=String(e.getHours()).padStart(2,"0"),u=String(e.getMinutes()).padStart(2,"0");return`${c}-${s} ${r}:${u}`}catch{return o}},_=o=>{b.push(`/activity/${o}`)},N=o=>{console.log("æŸ¥çœ‹ç”³è¯·è€…åˆ—è¡¨:",o),b.push(`/activity/${o}/applicants`)},H=o=>{b.push(`/activity/${o}`)},V=o=>{b.push(`/create-activity?id=${o}`)},I=o=>{v.value=o,g.value=!0},L=async()=>{if(v.value)try{await p.deleteActivity(v.value.toString()),D.success("æ´»åŠ¨å·²å–æ¶ˆ"),await z()}catch(o){console.error("å–æ¶ˆæ´»åŠ¨å¤±è´¥:",o),D.error("å–æ¶ˆæ´»åŠ¨å¤±è´¥")}finally{g.value=!1,v.value=null}};return(o,e)=>{const c=P("router-link");return n(),l("div",G,[t("div",Q,[e[7]||(e[7]=t("div",{class:"px-4 py-4"},[t("h1",{class:"text-2xl font-bold text-gray-800 text-center"},"å¾’æ­¥è®°å½•")],-1)),t("div",W,[t("button",{onClick:e[0]||(e[0]=s=>i.value="joined"),class:h(["flex-1 py-3 px-4 font-medium text-center transition-all relative",i.value==="joined"?"text-teal-600":"text-gray-600 hover:text-gray-800"])},[e[5]||(e[5]=t("span",null,"æˆ‘åŠ å…¥çš„",-1)),i.value==="joined"?(n(),l("div",X)):d("",!0)],2),t("button",{onClick:e[1]||(e[1]=s=>i.value="created"),class:h(["flex-1 py-3 px-4 font-medium text-center transition-all relative",i.value==="created"?"text-teal-600":"text-gray-600 hover:text-gray-800"])},[e[6]||(e[6]=t("span",null,"æˆ‘å‘å¸ƒçš„",-1)),i.value==="created"?(n(),l("div",Y)):d("",!0)],2)])]),t("div",Z,[i.value==="joined"?(n(),l("div",tt,[j.value.length>0?(n(),l("div",et,[(n(!0),l(x,null,m(j.value,s=>(n(),l("div",{key:s.id,onClick:r=>_(s.id),class:"activity-card-joined bg-white rounded-2xl shadow-md overflow-hidden hover:shadow-lg transition-all duration-300 cursor-pointer transform hover:-translate-y-1"},[t("div",ot,[t("img",{src:s.coverImage,alt:s.title,class:"w-full h-full object-cover"},null,8,lt),t("div",nt,[t("span",{class:h(["inline-block text-xs font-bold px-3 py-1 rounded-full text-white",s.status==="å¾…å‚åŠ "?"bg-teal-500":s.status==="è¿›è¡Œä¸­"?"bg-orange-500":s.status==="å·²å®Œæˆ"?"bg-green-500":"bg-gray-500"])},a(s.status),3)]),e[8]||(e[8]=t("div",{class:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"},null,-1))]),t("div",rt,[t("h3",at,a(s.title),1),t("div",it,[t("div",dt,[e[9]||(e[9]=t("svg",{class:"w-4 h-4 text-gray-500 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"})],-1)),t("span",null,a(A(s.startTime)),1)]),t("div",ct,[e[10]||(e[10]=t("svg",{class:"w-4 h-4 text-gray-500 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),t("span",null,a(s.location),1)])]),s.participants&&s.participants.length>0?(n(),l("div",ut,[t("div",pt,[(n(!0),l(x,null,m((s.participants||[]).slice(0,5),(r,u)=>(n(),l("img",{key:u,src:r.avatar,alt:r.name,title:r.name,class:"w-8 h-8 rounded-full border-2 border-white object-cover hover:z-10 transition-transform hover:scale-110"},null,8,gt))),128)),(s.participants||[]).length>5?(n(),l("div",xt," +"+a((s.participants||[]).length-5),1)):d("",!0)]),t("span",mt,a(s.participants.length)+"äººå‚åŠ  ",1)])):d("",!0)])],8,st))),128))])):(n(),l("div",ft,[e[12]||(e[12]=t("div",{class:"text-5xl mb-3 opacity-50"},"ğŸ¥¾",-1)),e[13]||(e[13]=t("p",{class:"text-gray-600 text-lg mb-4"},"è¿˜æ²¡æœ‰åŠ å…¥ä»»ä½•å¾’æ­¥æ´»åŠ¨",-1)),S(c,{to:"/discover",class:"inline-block px-6 py-2.5 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition font-semibold text-sm"},{default:M(()=>[...e[11]||(e[11]=[k(" å»å‘ç°æ´»åŠ¨ ",-1)])]),_:1})]))])):d("",!0),i.value==="created"?(n(),l("div",bt,[$.value.length>0?(n(),l("div",vt,[(n(!0),l(x,null,m($.value,s=>(n(),l("div",{key:s.id,class:"activity-card-created bg-white rounded-2xl shadow-md overflow-hidden hover:shadow-lg transition-all duration-300 group"},[t("div",{class:"relative overflow-hidden h-56 cursor-pointer",onClick:r=>_(s.id)},[t("img",{src:s.coverImage,alt:s.title,class:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"},null,8,_t),t("div",wt,[t("span",{class:h(["inline-block text-xs font-bold px-3 py-1 rounded-full text-white",s.status==="æ‹›å‹Ÿä¸­"?"bg-teal-500":s.status==="è¿›è¡Œä¸­"?"bg-orange-500":"bg-gray-500"])},a(s.status),3)]),t("div",yt,[t("span",kt," éš¾åº¦ "+a(s.difficulty||"3.0"),1)]),e[14]||(e[14]=t("div",{class:"absolute inset-0 bg-gradient-to-t from-black/30 to-transparent"},null,-1))],8,ht),t("div",Ct,[t("h3",{class:"font-bold text-lg text-gray-800 mb-3 cursor-pointer hover:text-teal-600 transition",onClick:r=>_(s.id)},a(s.title),9,jt),t("div",$t,[t("div",zt,[e[15]||(e[15]=t("svg",{class:"w-4 h-4 text-gray-500 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"})],-1)),t("span",null,a(A(s.startTime)),1)]),t("div",At,[e[16]||(e[16]=t("svg",{class:"w-4 h-4 text-gray-500 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),t("span",null,a(s.location),1)])]),s.status==="æ‹›å‹Ÿä¸­"?(n(),l("div",St,[t("div",Mt,[t("div",Dt,[t("div",Bt,[(n(!0),l(x,null,m((s.applicants||[]).slice(0,3),(r,u)=>(n(),l("img",{key:u,src:r.avatar,alt:r.name,title:r.name,class:"w-7 h-7 rounded-full border-2 border-white object-cover"},null,8,Tt))),128))]),t("span",Nt,[t("span",Ht,a(s.applicantCount||0),1),e[17]||(e[17]=k("äººç”³è¯·ä¸­ ",-1))])]),t("button",{onClick:f(r=>N(s.id),["stop"]),class:"text-sm text-teal-600 font-semibold hover:text-teal-700 whitespace-nowrap"}," æŸ¥çœ‹ç”³è¯· â†’ ",8,Vt)])])):s.status==="è¿›è¡Œä¸­"?(n(),l("div",It,[t("div",Lt,[t("div",qt,[t("div",Et,[(n(!0),l(x,null,m((s.participants||[]).slice(0,5),(r,u)=>(n(),l("img",{key:u,src:r.avatar,alt:r.name,title:r.name,class:"w-7 h-7 rounded-full border-2 border-white object-cover"},null,8,Ft))),128))]),t("span",Jt,a((s.participants||[]).length)+"äººå‚åŠ  ",1)]),t("button",{onClick:f(r=>H(s.id),["stop"]),class:"text-sm text-orange-600 font-semibold hover:text-orange-700 whitespace-nowrap"}," è¯¦æƒ… â†’ ",8,Pt)])])):d("",!0),t("div",Rt,[t("button",{onClick:f(r=>V(s.id),["stop"]),class:"flex-1 py-2 px-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition font-medium text-sm"}," ç¼–è¾‘ ",8,Kt),t("button",{onClick:f(r=>I(s.id),["stop"]),class:"flex-1 py-2 px-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium text-sm"}," å–æ¶ˆ ",8,Ot)])])]))),128))])):(n(),l("div",Ut,[e[19]||(e[19]=t("div",{class:"text-5xl mb-3 opacity-50"},"ğŸ—»",-1)),e[20]||(e[20]=t("p",{class:"text-gray-600 text-lg mb-4"},"è¿˜æ²¡æœ‰å‘å¸ƒä»»ä½•å¾’æ­¥æ´»åŠ¨",-1)),S(c,{to:"/create-activity",class:"inline-block px-6 py-2.5 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition font-semibold text-sm"},{default:M(()=>[...e[18]||(e[18]=[k(" å‘å¸ƒç¬¬ä¸€ä¸ªæ´»åŠ¨ ",-1)])]),_:1})]))])):d("",!0)]),g.value?(n(),l("div",{key:0,onClick:e[4]||(e[4]=s=>g.value=!1),class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},[t("div",{onClick:e[3]||(e[3]=f(()=>{},["stop"])),class:"bg-white rounded-3xl w-full max-w-sm p-6 animate-scale-in"},[e[21]||(e[21]=R('<div class="text-center mb-6" data-v-4b991efd><div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4" data-v-4b991efd><svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-4b991efd><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-4b991efd></path></svg></div><h3 class="text-xl font-bold text-gray-900 mb-2" data-v-4b991efd>ç¡®è®¤å–æ¶ˆè¯¥æ´»åŠ¨å—ï¼Ÿ</h3><p class="text-gray-600 text-sm" data-v-4b991efd>æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼Œæ´»åŠ¨å–æ¶ˆåæ‰€æœ‰å‚ä¸è€…éƒ½ä¼šæ”¶åˆ°é€šçŸ¥ã€‚</p></div>',1)),t("div",Gt,[t("button",{onClick:e[2]||(e[2]=s=>g.value=!1),class:"flex-1 py-3 rounded-xl bg-gray-100 text-gray-700 font-semibold hover:bg-gray-200 transition"}," æˆ‘å†æƒ³æƒ³ "),t("button",{onClick:L,class:"flex-1 py-3 rounded-xl bg-red-500 text-white font-semibold hover:bg-red-600 transition"}," ç¡®è®¤å–æ¶ˆ ")])])])):d("",!0)])}}}),se=U(Qt,[["__scopeId","data-v-4b991efd"]]);export{se as default};
