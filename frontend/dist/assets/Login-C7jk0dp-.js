import{k as x,J as _,E as N,r as n,l as k,F as U,v as m,q as c,z as s,K as q,x as S,A as v,L as f,M as b,N as y,s as V,u as h}from"./vue-Dq4PaVdn.js";import{u as M,i as C,t as u,_ as I}from"./index-Bhs_HTB-.js";import"./state-COm4LJOs.js";const L={class:"login-container"},B={class:"login-card"},D={key:0,class:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-600 text-sm"},E=["disabled"],R={class:"text-center mt-4"},T=x({__name:"Login",setup(z){const d=_(),t=N(),p=M(),a=n(!1),r=n(""),o=n({email:"",password:""});k(()=>{t.query.email&&(o.value.email=t.query.email),t.query.password&&(o.value.password=t.query.password),t.query.isNewUser==="true"&&sessionStorage.setItem("isNewUser","true")});const g=async()=>{a.value=!0,r.value="";try{await p.login(o.value)?(C(),u.success("登录成功"),sessionStorage.getItem("isNewUser")==="true"?(sessionStorage.removeItem("isNewUser"),d.push("/user-guide")):d.push("/discover")):(r.value=p.error||"登录失败，请检查邮箱和密码",u.error(r.value))}catch(l){console.error("登录失败:",l),r.value="登录失败，请重试",u.error(r.value)}finally{a.value=!1}};return(l,e)=>{const w=U("router-link");return c(),m("div",L,[s("div",B,[e[6]||(e[6]=s("h1",{class:"text-2xl font-bold mb-6 text-center"},"登录",-1)),s("form",{onSubmit:q(g,["prevent"]),class:"space-y-4"},[r.value?(c(),m("div",D,v(r.value),1)):S("",!0),s("div",null,[e[2]||(e[2]=s("label",{for:"email",class:"block text-sm font-medium mb-2"},"邮箱",-1)),f(s("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>o.value.email=i),type:"email",id:"email",placeholder:"请输入邮箱",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-primary",required:""},null,512),[[b,o.value.email]])]),s("div",null,[e[3]||(e[3]=s("label",{for:"password",class:"block text-sm font-medium mb-2"},"密码",-1)),f(s("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>o.value.password=i),type:"password",id:"password",placeholder:"请输入密码",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-primary",required:""},null,512),[[b,o.value.password]])]),s("button",{type:"submit",disabled:a.value,class:"w-full bg-primary text-white py-2 rounded-lg hover:bg-secondary disabled:opacity-50"},v(a.value?"登录中...":"登录"),9,E)],32),s("p",R,[e[5]||(e[5]=y(" 没有账号？ ",-1)),V(w,{to:"/register",class:"text-primary hover:underline"},{default:h(()=>[...e[4]||(e[4]=[y(" 立即注册 ",-1)])]),_:1})])])])}}}),K=I(T,[["__scopeId","data-v-9f858c4c"]]);export{K as default};
