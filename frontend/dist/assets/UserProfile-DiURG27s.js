import{k as N,J as U,E as $,r as m,d as k,l as z,v as r,q as n,z as e,x as f,A as i,O as b,P as _,y as j,G as P}from"./vue-Eb8ZdQV1.js";import{t as c,b as h,_ as R}from"./index-BAE1sWos.js";import{a as S}from"./activity-CBna8Trh.js";import"./state-WzMdx_T8.js";const B={class:"user-profile-page min-h-screen bg-white"},F={class:"relative h-64 overflow-hidden"},M=["src"],E={key:1,class:"w-full h-full bg-gradient-to-br from-teal-400 to-blue-500"},J={class:"relative px-4 -mt-16"},V={class:"bg-white rounded-3xl shadow-xl p-6"},q={class:"flex items-center mb-4"},G=["src"],O={class:"ml-4 flex-1"},H={class:"flex items-center gap-2"},K={class:"text-2xl font-bold text-gray-800"},Q={class:"px-3 py-1 bg-teal-500 text-white text-xs rounded-full font-semibold"},W={key:0,class:"text-gray-600 text-sm mt-1"},X={class:"grid grid-cols-2 gap-4 py-4 border-t border-b border-gray-100"},Y={class:"text-center"},Z={class:"text-2xl font-bold text-gray-800"},ee={class:"text-center"},te={class:"text-2xl font-bold text-gray-800"},se={class:"px-4 mt-6"},le={class:"bg-white rounded-2xl p-5 shadow-sm"},oe={class:"text-gray-700 text-sm leading-relaxed"},ae={class:"px-4 mt-6"},ie={class:"flex items-center justify-between mb-4"},re={key:0,class:"text-teal-500 text-sm font-medium"},ne={class:"grid grid-cols-3 gap-3"},de=["src","alt"],ce={class:"absolute bottom-0 left-0 right-0 p-3 text-white"},ue={class:"font-bold text-sm mb-1"},ge={class:"text-xs opacity-90"},ve={key:0,class:"px-4 mt-6"},xe={class:"flex items-center justify-between mb-4"},me={class:"text-teal-500 text-sm font-medium"},fe={class:"space-y-3"},he=["onClick"],pe=["src","alt"],be={class:"ml-3 flex-1 flex flex-col justify-center"},_e={class:"font-bold text-gray-800 mb-1 line-clamp-1"},ye={class:"flex items-center text-xs text-gray-500 mb-1"},we={class:"mr-2"},ke={class:"flex items-center justify-between mt-1"},je={class:"px-4 mt-6 pb-32"},Ce={class:"flex gap-3 flex-wrap"},Ae={class:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-100 p-4 shadow-lg"},De={class:"flex gap-3 max-w-lg mx-auto"},Ie=["disabled"],Te={key:0},Le={key:1},Ne={key:0,class:"h-14 bg-gray-100 text-gray-700 rounded-2xl font-bold text-base hover:bg-gray-200 transition px-6"},Ue=N({__name:"UserProfile",setup($e){const g=U(),C=$(),t=m(null),y=m(!0),u=m(!1),v=m(!1),A=k(()=>{var a,s;return((s=(a=t.value)==null?void 0:a.hikingTrails)==null?void 0:s.slice(0,3))||[]}),w=k(()=>{var a,s;return((s=(a=t.value)==null?void 0:a.publishedActivities)==null?void 0:s.slice(0,3))||[]}),D=a=>({ç™»å±±:"â›°ï¸",æ‘„å½±:"ğŸ“·",éœ²è¥:"â›º",å¾’æ­¥:"ğŸ¥¾",è¶Šé‡:"ğŸƒ",å†’é™©:"ğŸ§—",äº¤å‹:"ğŸ‘¥",æˆ·å¤–:"ğŸŒ²",è·¯çº¿å¼€å‘:"ğŸ—ºï¸",è‡ªç„¶:"ğŸƒ",éª‘è¡Œ:"ğŸš´",è¿åŠ¨:"âš½",è¯—æ­Œ:"âœï¸",æ—…æ¸¸:"âœˆï¸",ç¾é£Ÿ:"ğŸœ",å® ç‰©:"ğŸ•",æ…¢ç”Ÿæ´»:"â˜•"})[a]||"ğŸ·ï¸",I=()=>{g.back()},T=async()=>{if(!(!t.value||v.value))try{v.value=!0;const a=t.value.id;if(u.value){const s=await h.unfollowUser(a);s.code===200?(u.value=!1,t.value.stats.followers=Math.max(0,t.value.stats.followers-1),c.success("å·²å–æ¶ˆå…³æ³¨")):c.error(s.message||"å–æ¶ˆå…³æ³¨å¤±è´¥")}else{const s=await h.followUser(a);s.code===200?(u.value=!0,t.value.stats.followers+=1,c.success("å…³æ³¨æˆåŠŸ")):c.error(s.message||"å…³æ³¨å¤±è´¥")}}catch(a){console.error("å…³æ³¨æ“ä½œå¤±è´¥:",a),c.error("æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•")}finally{v.value=!1}};return z(async()=>{var s;const a=C.params.id;if(!a||a==="NaN"){c.error("ç”¨æˆ·IDæ— æ•ˆ"),g.back();return}try{y.value=!0;const[l,x,p]=await Promise.all([h.getUserDetail(a),S.getUserJoinedActivities(a,{page_size:3}),h.getFollowStatus(a)]);if(l.code===200&&l.data){const o=l.data,L=((s=x.data)==null?void 0:s.items)||[];p.code===200&&p.data&&(u.value=p.data.is_following),t.value={id:o.id,nickname:o.nickname,gender:o.gender==="male"?"ç”·":o.gender==="female"?"å¥³":"å…¶ä»–",age:o.age||0,bio:o.bio||"è¿™ä¸ªäººå¾ˆæ‡’ï¼Œä»€ä¹ˆéƒ½æ²¡å†™...",hikingLevel:o.hiking_level||"æ–°æ‰‹",province:o.province||"",city:o.city||"",region:o.region||"",tags:(o.preferences||[]).map(d=>d.preference_value),avatar:o.avatar_url||`https://api.dicebear.com/7.x/avataaars/svg?seed=user${a}`,coverImage:o.photos&&o.photos[0]?o.photos[0].photo_url:"",stats:{activities:o.activities_count||0,followers:o.followers_count||0,following:0},hikingTrails:L.map(d=>({id:d.id,title:d.title,date:new Date(d.start_time).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit"}).replace(/\//g,"."),image:d.cover_image_url||"https://images.unsplash.com/photo-1551632811-561732d1e306?w=300&h=400&fit=crop"})),publishedActivities:o.photos?o.photos.slice(0,3).map(d=>({id:d.id,title:`ç…§ç‰‡ ${d.display_order}`,date:new Date(d.created_at).toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"}),location:o.region||o.city||o.province||"åœ°ç‚¹æœªçŸ¥",image:d.photo_url,status:"completed"})):[]}}else c.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥"),g.back()}catch(l){console.error("åŠ è½½ç”¨æˆ·èµ„æ–™å¤±è´¥:",l),c.error("åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•"),g.back()}finally{y.value=!1}}),(a,s)=>(n(),r("div",B,[e("div",F,[t.value&&t.value.coverImage?(n(),r("img",{key:0,src:t.value.coverImage,alt:"Cover",class:"w-full h-full object-cover"},null,8,M)):(n(),r("div",E)),s[2]||(s[2]=e("div",{class:"absolute inset-0 bg-gradient-to-b from-black/30 to-transparent"},null,-1)),e("div",{class:"absolute top-0 left-0 right-0 flex items-center justify-between p-4"},[e("button",{onClick:I,class:"w-10 h-10 bg-white/90 backdrop-blur rounded-full flex items-center justify-center shadow-md"},[...s[0]||(s[0]=[e("span",{class:"text-xl"},"â†",-1)])]),s[1]||(s[1]=e("button",{class:"w-10 h-10 bg-white/90 backdrop-blur rounded-full flex items-center justify-center shadow-md"},[e("span",{class:"text-xl"},"â‹¯")],-1))])]),e("div",J,[e("div",V,[e("div",q,[e("img",{src:t.value&&t.value.avatar||"https://api.dicebear.com/7.x/avataaars/svg?seed=default",alt:"Avatar",class:"w-16 h-16 rounded-full border-4 border-white shadow-md"},null,8,G),e("div",O,[e("div",H,[e("h2",K,i(t.value&&t.value.nickname||"åŠ è½½ä¸­..."),1),e("span",Q,i(t.value&&t.value.hikingLevel||"æ–°æ‰‹"),1)]),t.value&&(t.value.region||t.value.province||t.value.city)?(n(),r("p",W," ğŸ“ "+i(t.value.region||`${t.value.province||""} ${t.value.city||""}`.trim()),1)):f("",!0)])]),e("div",X,[e("div",Y,[e("div",Z,i(t.value&&t.value.stats&&t.value.stats.activities||0),1),s[3]||(s[3]=e("div",{class:"text-xs text-gray-500 mt-1"},"å¾’æ­¥æ¬¡æ•°",-1))]),e("div",ee,[e("div",te,i(t.value&&t.value.stats&&t.value.stats.followers||0),1),s[4]||(s[4]=e("div",{class:"text-xs text-gray-500 mt-1"},"å…³æ³¨è€…",-1))])])])]),e("div",se,[e("div",le,[s[5]||(s[5]=e("h3",{class:"text-lg font-bold text-gray-800 mb-3"},"ä¸ªäººç®€ä»‹",-1)),e("p",oe,i(t.value&&t.value.bio||"çƒ­çˆ±å¤§è‡ªç„¶çš„å±±é‡æ‹¾è’è€…ã€‚å·²ç»åœ¨å‘¨æœ«å¾æœäº†è‹æµ™æ²ªå‘¨è¾¹å¤§éƒ¨åˆ†å±±å³°ï¼Œå¸Œæœ›èƒ½åœ¨è¿™é‡Œé‡åˆ°å¿—åŒé“åˆã€èŠ‚å¥ä¸€è‡´çš„å°ä¼™ä¼´ä¸€èµ·æ¢ç´¢æ›´è¿œçš„é«˜å±±ã€‚æ€§æ ¼å¼€æœ—ï¼Œå¯ä»¥å¸®å¿™æ‹ç…§å’Œè´Ÿé‡ã€‚"),1)])]),e("div",ae,[e("div",ie,[s[6]||(s[6]=e("h3",{class:"text-lg font-bold text-gray-800"},"å¾’æ­¥è¶³è¿¹",-1)),t.value&&t.value.hikingTrails&&t.value.hikingTrails.length?(n(),r("button",re," æŸ¥çœ‹å…¨éƒ¨ "+i(t.value.hikingTrails.length),1)):f("",!0)]),e("div",ne,[(n(!0),r(b,null,_(A.value,(l,x)=>(n(),r("div",{key:x,class:"relative rounded-2xl overflow-hidden shadow-md",style:{"aspect-ratio":"3/4"}},[e("img",{src:l.image,alt:l.title,class:"w-full h-full object-cover"},null,8,de),s[7]||(s[7]=e("div",{class:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"},null,-1)),e("div",ce,[e("h4",ue,i(l.title),1),e("p",ge,i(l.date),1)])]))),128))])]),w.value.length>0?(n(),r("div",ve,[e("div",xe,[s[8]||(s[8]=e("h3",{class:"text-lg font-bold text-gray-800"},"å‘å¸ƒçš„æ´»åŠ¨",-1)),e("button",me," æŸ¥çœ‹å…¨éƒ¨ "+i(t.value&&t.value.stats&&t.value.stats.activities),1)]),e("div",fe,[(n(!0),r(b,null,_(w.value,l=>(n(),r("div",{key:l.id,class:"flex bg-white rounded-2xl p-3 shadow-md active:scale-95 transition-transform cursor-pointer",onClick:x=>P(g).push(`/activity/${l.id}`)},[e("img",{src:l.image,alt:l.title,class:"w-20 h-20 rounded-xl object-cover"},null,8,pe),e("div",be,[e("h4",_e,i(l.title),1),e("div",ye,[e("span",we,"ğŸ“… "+i(l.date),1),e("span",null,"ğŸ“ "+i(l.location),1)]),e("div",ke,[e("span",{class:j(["text-xs px-2 py-0.5 rounded-full",{"bg-green-100 text-green-600":l.status==="ongoing","bg-blue-100 text-blue-600":l.status==="pending"||l.status==="approved","bg-gray-100 text-gray-600":l.status==="completed"||l.status==="cancelled"}])},i(l.status==="ongoing"?"è¿›è¡Œä¸­":l.status==="completed"?"å·²ç»“æŸ":"æ‹›å‹Ÿä¸­"),3),s[9]||(s[9]=e("span",{class:"text-teal-500 text-xs font-bold"},"ç‚¹å‡»åŠ å…¥ >",-1))])])],8,he))),128))])])):f("",!0),e("div",je,[s[10]||(s[10]=e("h3",{class:"text-lg font-bold text-gray-800 mb-4"},"å…´è¶£çˆ±å¥½",-1)),e("div",Ce,[(n(!0),r(b,null,_(t.value&&t.value.tags||[],l=>(n(),r("span",{key:l,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium"},i(D(l))+" "+i(l),1))),128))])]),e("div",Ae,[e("div",De,[s[11]||(s[11]=e("button",{class:"flex-shrink-0 w-14 h-14 bg-white border-2 border-gray-200 rounded-2xl flex items-center justify-center text-2xl hover:border-teal-500 transition"}," ğŸ’¬ ",-1)),e("button",{class:j(["h-14 rounded-2xl font-bold text-base transition shadow-lg",u.value?"bg-gray-100 text-gray-700 hover:bg-gray-200 px-6":"flex-1 bg-teal-500 text-white hover:bg-teal-600"]),onClick:T,disabled:v.value},[v.value?(n(),r("span",Te,"å¤„ç†ä¸­...")):(n(),r("span",Le,i(u.value?"å·²å…³æ³¨":"+ å…³æ³¨"),1))],10,Ie),u.value?f("",!0):(n(),r("button",Ne," é‚€è¯·å¾’æ­¥ "))])])]))}}),Be=R(Ue,[["__scopeId","data-v-40bdd6ff"]]);export{Be as default};
