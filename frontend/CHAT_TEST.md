# 聊天功能测试指南

## 🚀 快速测试

### 方法1：从消息列表进入

1. 访问 `http://localhost:5173/messages`
2. 点击任意聊天项（例如"李华 (徒步达人)"）
3. 应该跳转到 `/chat/1` 并显示聊天界面

### 方法2：直接访问聊天页面

```
http://localhost:5173/chat/1
http://localhost:5173/chat/2
http://localhost:5173/chat/3
http://localhost:5173/chat/4
```

## 🎯 预期效果

### 页面布局（从上到下）

1. **顶部导航栏**（白色背景）
   - 返回按钮（左上角）
   - 用户头像
   - 用户名称 + 在线状态

2. **消息列表区域**（灰色背景，可滚动）
   - 显示4条历史消息
   - 对方消息：左侧，白色气泡
   - 自己消息：右侧，青绿色气泡

3. **输入区域**（白色背景，固定底部）
   - Emoji选择器（点击笑脸按钮打开）
   - 语音按钮（左侧，灰色圆形）
   - 输入框（中间，灰色圆角）
   - Emoji按钮（输入框内右侧）
   - 图片按钮（输入框内右侧）
   - 发送按钮（右侧，青绿色圆形）

## ✅ 功能测试清单

### 1. 文字消息

- [ ] 在输入框输入文字
- [ ] 输入框随内容自动扩展高度
- [ ] 按Enter键发送消息
- [ ] 消息显示在右侧青绿色气泡
- [ ] 1秒后收到"收到！👍"的自动回复
- [ ] 页面自动滚动到底部

### 2. Emoji表情

- [ ] 点击输入框内的笑脸按钮
- [ ] Emoji选择器在输入框上方打开
- [ ] 显示24个表情图标
- [ ] 点击某个表情
- [ ] 表情插入到输入框
- [ ] 光标自动回到输入框
- [ ] 点击页面其他地方，选择器自动关闭

### 3. 图片发送

- [ ] 点击输入框内的图片按钮
- [ ] 系统文件选择器打开
- [ ] 可选择多张图片
- [ ] 图片显示在消息列表
- [ ] 点击图片消息
- [ ] 全屏预览图片
- [ ] 点击任意位置关闭预览

### 4. 语音录制

- [ ] **按住**语音按钮（灰色圆形）
- [ ] 按钮变红并放大
- [ ] 底部显示录音提示和时长
- [ ] **松开**按钮
- [ ] 如果≥1秒，发送语音消息
- [ ] 语音消息显示时长
- [ ] **按住后移出**按钮区域
- [ ] 录音取消，不发送

### 5. 返回按钮

- [ ] 点击左上角返回按钮
- [ ] 返回到消息列表页面

## 🐛 故障排查

### 问题1：看不到聊天界面

**原因**：页面可能被底部导航栏遮挡
**解决**：

- ChatWindow 已改为 `fixed inset-0` 全屏布局
- z-index 设为 40，确保在顶层
- 刷新页面试试

### 问题2：点击消息列表项没反应

**检查步骤**：

1. 打开浏览器控制台（F12）
2. 查看是否有JavaScript错误
3. 检查路由是否正确跳转
4. 确认 `/chat/:id` 路由已配置

**Messages.vue 点击事件**：

```typescript
const openChat = (chat: Chat) => {
  router.push(`/chat/${chat.id}`)
}
```

### 问题3：输入框看不见或被遮挡

**原因**：布局问题
**检查**：

- 确认输入区域有 `flex-shrink-0` 类
- 确认外层容器是 `flex flex-col`
- 查看是否有其他fixed元素遮挡

### 问题4：无法输入文字

**检查**：

- 确认 `v-model="messageInput"` 绑定正确
- 确认 ref 定义存在
- 控制台是否有错误

### 问题5：Emoji选择器不显示

**检查**：

- 点击笑脸按钮后，`showEmojiPicker` 应该变为 `true`
- 控制台查看是否有Vue警告
- 检查 z-index 层级

## 📱 浏览器兼容性

- ✅ Chrome/Edge（推荐）
- ✅ Firefox
- ✅ Safari
- ⚠️ 移动端浏览器（触摸事件已支持）

## 🔍 调试技巧

### 使用Vue DevTools

1. 安装Vue DevTools浏览器插件
2. 打开开发者工具
3. 切换到Vue标签
4. 查看组件状态（messageInput, showEmojiPicker, isRecording等）

### 控制台日志

打开控制台，应该能看到：

- "播放语音消息: xxx" （点击语音消息时）
- 路由导航日志

### 网络检查

- 查看图片是否加载成功（Network标签）
- 头像图片URL: unsplash.com

## 💡 常见操作提示

### 发送消息的3种方式

1. 输入文字 → 点击发送按钮
2. 输入文字 → 按Enter键
3. 按住语音按钮 → 松开

### Emoji表情的使用

1. 点击笑脸按钮打开
2. 点击表情插入
3. 继续输入文字
4. 发送带表情的消息

### 图片的操作

1. 发送：点击图片按钮 → 选择图片
2. 预览：点击消息中的图片
3. 关闭预览：点击任意位置或X按钮

## 🎨 设计规范

- **主题色**：Teal-500 (#14B8A6)
- **圆角**：rounded-2xl (16px)
- **间距**：p-4 (16px)
- **文字大小**：
  - 标题：text-lg
  - 正文：text-sm
  - 时间：text-xs
- **气泡颜色**：
  - 发送：bg-teal-500 text-white
  - 接收：bg-white text-gray-800

## 📝 测试记录

| 功能      | 状态 | 备注   |
| --------- | ---- | ------ |
| 页面加载  | ⏳   | 待测试 |
| 文字发送  | ⏳   | 待测试 |
| Emoji选择 | ⏳   | 待测试 |
| 图片上传  | ⏳   | 待测试 |
| 语音录制  | ⏳   | 待测试 |
| 返回导航  | ⏳   | 待测试 |

测试完成后请更新状态：

- ✅ 通过
- ❌ 失败
- ⚠️ 部分功能异常
