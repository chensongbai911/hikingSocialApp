# vNext 快速参考卡 (Quick Reference)

**打印或保存以供快速查阅**

---

## 📍 项目概览

| 项           | 值                                     |
| ------------ | -------------------------------------- |
| **项目名**   | 徒步社交 App vNext                     |
| **核心目标** | 路线前-中-后闭环 + 队伍协同 + 安全体系 |
| **上线日期** | 2026-04-20                             |
| **总工期**   | 14 周 (含代码优化 + 4 个 Sprint)       |
| **总工作量** | ~200 人天                              |
| **推荐人数** | BE 3-4 + FE 3-4 + Design 1-2 + QA 1    |

---

## 🎯 3 大核心决策 (待你确认)

> ⚠️ **重要**: 请先阅读 `vNext_PM_DECISION_CHECKLIST.md` 获取详细分析后再确认决策
> 📄 决策清单提供了每个选项的优劣分析、成本对比和工期影响

### 1️⃣ 路线数据来源

**您的决策**:

```
☐ 平台精选为主 (快速冷启动, 0 周)
☐ 用户创建为主 (UGC 驱动, +1 周)
☐ GPX 导入支持 (专业用户, +1 周)
☐ 混合模式 ✅ (推荐: 平台精选 → UGC → GPX, +1 周)

✍️ 我的选择: ___________________
✍️ 决策理由: ___________________
```

### 2️⃣ 地图与离线方案

**地图选择**:

```
☐ 高德 AMap SDK ✅ (推荐, +2 周, 500-1000元/月)
☐ 开源 Leaflet + OSM (免费, +1.5 周, 功能受限)
☐ 静态地图占位 (快速, +2 天, 后期需重构)

✍️ 我的选择: ___________________
```

**离线能力**:

```
☐ 完全离线 (地图切片预下载, +3 周)
☐ 简化离线 ✅ (推荐: 缓存关键数据, +1 周)
☐ 暂不支持 (后续迭代, 0 周)

✍️ 我的选择: ___________________
✍️ Lynx 端离线需求: ___________________
```

### 3️⃣ SOS 外联方案

**您的决策**:

```
☐ 站内通知 + 救援卡片 ✅ (推荐, +1 周, 0 成本)
☐ 短信网关 (+1 周, 200-1000元/月)
☐ 第三方救援服务 (+4 周, 商务谈判)
☐ 站内 + 预留外部接口 (灵活, +1 周)

✍️ 我的选择: ___________________
✍️ 决策理由: ___________________
```

**紧急联系人处理**:

```
☐ 用户手动添加联系人 (姓名 + 手机)
☐ 从通讯录选择 (需要权限)
☐ 从 App 好友中选择

✍️ 我的选择: ___________________
```

---

### ✅ 决策确认签字

```
决策人: ___________________
日期: 2026-01-___
预期工期: ___ 周
可接受延迟: ±___ 周

决策已同步给:
☐ Tech Lead (BE)
☐ Tech Lead (FE)
☐ Design Lead
☐ QA Lead
```

---

## 📊 5 大业务问题 (需要确认)

| #   | 问题               | 选项           | 决策   |
| --- | ------------------ | -------------- | ------ |
| 1   | 新手准备助手优先级 | P0 / P1 ✅     | \_\_\_ |
| 2   | 离线能力首发包含   | 是 / 否 ✅     | \_\_\_ |
| 3   | 轨迹数据默认隐私   | 公开 / 私密 ✅ | \_\_\_ |
| 4   | 队伍人数上限       | <= 20 ✅       | \_\_\_ |
| 5   | 轨迹采样频率       | 10 秒/点 ✅    | \_\_\_ |

---

## 🛠️ 技术清单 (需要确认)

| 工具/服务         | 状态 | 备注              |
| ----------------- | ---- | ----------------- |
| 高德 AMap Key     | ❓   | 需要购买          |
| 和风 QWeather API | ❓   | 需要购买          |
| Redis 生产环境    | ❓   | 缓存位置共享      |
| iOS APNs 配置     | ❓   | 推送通知          |
| Android FCM 配置  | ❓   | 推送通知          |
| Lynx 框架         | ❓   | iOS/Android 能力? |
| MySQL >= 5.7      | ✅   | 支持 JSON 类型    |

---

## 📅 关键里程碑

```
第 0 阶段 (1 周): 需求 + 设计确认
  ↓
第 1 阶段 (2 周): 代码优化
  [1/26 完成] ← 产品 + 技术准备完毕
  ↓
Sprint 1 (3 周): 路线 + 数据库 + API
  [2/16 完成] ← 路线系统内测
  ↓
Sprint 2 (3 周): 轨迹 + 复盘 + 分享
  [3/2 完成] ← 轨迹记录可用
  ↓
Sprint 3 (2 周): 队伍协同 + 实时
  [3/16 完成] ← 队伍房间可用
  ↓
Sprint 4 (4 周): 安全 + 测试 + 优化
  [4/6 完成] ← 功能完整
  ↓
UAT + 优化 (1 周)
  [4/13 完成]
  ↓
上线 🚀 [4/20]
```

---

## 📚 文档导航

### 给 PM (产品负责人)

| 文档                                | 用途                | 阅读时间 |
| ----------------------------------- | ------------------- | -------- |
| **vNext_EXECUTIVE_SUMMARY.md**      | 全局理解 + 决策输入 | 15 分钟  |
| **vNext_IMPLEMENTATION_GUIDE.md**   | 项目管理 + 里程碑   | 20 分钟  |
| vNext_PRD_ANALYSIS_COMPREHENSIVE.md | 深度技术理解 (可选) | 45 分钟  |

**行动**: 确认 3 大决策 → 收集 5 个问题答案 → 准备设计稿 → 确认人力

### 给 Tech Lead (后端)

| 文档                                    | 用途                  | 阅读时间 |
| --------------------------------------- | --------------------- | -------- |
| **vNext_PRD_ANALYSIS_COMPREHENSIVE.md** | 架构设计 + 数据库设计 | 40 分钟  |
| **CURRENT_CODE_OPTIMIZATION_PLAN.md**   | 代码优化路线          | 20 分钟  |
| vNext_IMPLEMENTATION_GUIDE.md           | 风险与缓解 (可选)     | 15 分钟  |

**行动**: 评审数据库 DDL → 启动 TypeScript strict → 准备 API 文档

### 给 Tech Lead (前端)

| 文档                                              | 用途                  | 阅读时间 |
| ------------------------------------------------- | --------------------- | -------- |
| **vNext_PRD_ANALYSIS_COMPREHENSIVE.md** 第 4.3 节 | 前端架构设计          | 20 分钟  |
| **CURRENT_CODE_OPTIMIZATION_PLAN.md**             | 代码优化 + API 层重构 | 20 分钟  |
| vNext_IMPLEMENTATION_GUIDE.md                     | 项目进度 (可选)       | 15 分钟  |

**行动**: 评审 apiService 设计 → 启动 console.log 清理 → 准备地图集成 demo

### 给 QA / 测试

| 文档                                           | 用途                | 阅读时间 |
| ---------------------------------------------- | ------------------- | -------- |
| **vNext_IMPLEMENTATION_GUIDE.md** 上线前验收   | 测试计划 + 验收标准 | 25 分钟  |
| **vNext_PRD_ANALYSIS_COMPREHENSIVE.md** Part 4 | 任务详情 + 验收细节 | 30 分钟  |

**行动**: 制定 Sprint 测试计划 → 准备性能基准 → 准备 UAT 场景

---

## 🚀 6 步快速启动

### 第 1 步: PM 确认 (今天)

```
⏱️ 15 分钟
✅ 阅读 vNext_EXECUTIVE_SUMMARY.md
✅ 确认 3 大决策 + 5 个问题
✅ 转发给相关负责人
```

### 第 2 步: Tech 评审 (今天)

```
⏱️ 1 小时
✅ Tech Lead (BE) 评审数据库 DDL
✅ Tech Lead (FE) 评审前端架构
✅ 确认外部 API 集成方案
```

### 第 3 步: 设计交付 (明天-后天)

```
⏱️ 2-3 天
✅ 设计出 8+ 核心页面高保真
✅ 准备组件库规范
✅ 准备动效说明
```

### 第 4 步: 人力确认 (本周末)

```
⏱️ 30 分钟
✅ 确认 BE/FE/Design/QA 人数和时间
✅ 分配 Sprint Lead
✅ 准备启动会议
```

### 第 5 步: 环境准备 (下周一)

```
⏱️ 1-2 天
✅ 创建 GitHub 分支 (feature/vNext)
✅ 初始化后端新模块目录
✅ 初始化前端新模块目录
✅ 购买/确认外部 API (AMap/QWeather)
```

### 第 6 步: 第 1 阶段启动 (下周一-五)

```
⏱️ 2 周
✅ 启动代码优化 (4 个并行任务)
✅ 每周三技术同步
✅ 2 月 2 日完成，Sprint 1 启动准备
```

---

## ⚠️ 关键风险与缓解

| 风险            | 影响         | 缓解方案                  | 拥有者    |
| --------------- | ------------ | ------------------------- | --------- |
| 高德 API 集成难 | 地图不可用   | 提前 demo, 有静态图降级   | FE_Lead   |
| GPS 定位精度差  | 队伍协同差   | 异常处理 + 手动修正       | FE_Dev    |
| Socket 消息丢失 | 实时不可靠   | 客户端队列 + 服务端持久化 | BE_Senior |
| 轨迹查询性能    | 大数据慢     | 分区表 + 缓存             | BE_Senior |
| 和风 API 限流   | 天气获取失败 | 后端缓存 + 预预加载       | BE_Mid    |
| Sprint 1 延期   | 整体延迟     | 增加人手 + 缩小范围       | PM + Tech |

---

## ✅ 上线前检查清单

### 功能检查

```
☐ 路线 CRUD 完整
☐ 关键点 >= 6 种类型
☐ 轨迹记录 + 离线缓存
☐ 轨迹 vs 路线对比 + 偏航检测
☐ 复盘报告自动生成
☐ 分享卡片导出
☐ 队伍房间管理
☐ 位置共享 (隐私可控)
☐ 4 种状态上报
☐ SOS 手动触发
☐ 自动失联检测 (>= 1 种)
☐ 紧急联系人管理
```

### 质量检查

```
☐ TypeScript strict 100%
☐ 单元测试 > 80%
☐ 集成测试 > 70%
☐ console.log 零留存
☐ 生产无内存泄漏
☐ API 文档完整 (Swagger)
☐ 数据库 ER 图完整
☐ 部署脚本可用
```

### 性能检查

```
☐ API 响应 p99 < 500ms
☐ 首屏加载 < 3s (无缓存)
☐ 首屏加载 < 1s (有缓存)
☐ 无 N+1 查询
☐ Socket 延迟 < 5s
☐ 轨迹点插入性能 (> 100 点/秒)
```

### 安全检查

```
☐ 认证覆盖所有 API
☐ 授权检查完备
☐ SQL 注入防护 (Prepared Statements)
☐ CSRF token 验证
☐ 限流已启用
☐ Socket 消息验证
☐ 位置数据加密
☐ 敏感数据脱敏
☐ 无日志泄露
```

---

## 📞 联系方式

| 角色    | 名字   | 电话   | 邮箱   |
| ------- | ------ | ------ | ------ |
| PM      | \_\_\_ | \_\_\_ | \_\_\_ |
| BE Lead | \_\_\_ | \_\_\_ | \_\_\_ |
| FE Lead | \_\_\_ | \_\_\_ | \_\_\_ |
| Design  | \_\_\_ | \_\_\_ | \_\_\_ |
| QA      | \_\_\_ | \_\_\_ | \_\_\_ |

---

## 💡 常见问题速查

### "为什么要先做代码优化？"

→ 坚实的基础减少 vNext 中的集成问题，省时间。

### "TypeScript strict 启用多难？"

→ 初期 100+ 错误，但 3-5 天可修好。后期 bug 少 30-50%。

### "可以并行做 Sprint 吗？"

→ Sprint 2 & 3 可并行，但 Sprint 1 必须完成。

### "如何应对外部 API 失败？"

→ 文档预留了降级方案 (静态图 + 默认规则)。

### "需要多少人？"

→ 最少配: 2BE + 2FE + 1Design + 1QA
→ 建议配: 3-4BE + 3-4FE + 1-2Design + 1QA

### "Lynx 框架会增加复杂度吗？"

→ 不会。我们先在 Web 上完善，再移植到 Lynx (第二阶段)。

### "万一赶不上 4 月 20 日怎么办？"

→ 优先保证 P0 功能 (路线 + 轨迹 + 队伍 + 安全)。P1 可延后。

---

## 🎓 团队培训主题

- [ ] vNext 整体架构 (1 小时)
- [ ] API 规范与最佳实践 (1 小时)
- [ ] 前端数据层新架构 (1.5 小时)
- [ ] 地理计算基础 (1 小时)
- [ ] Socket.io 高级用法 (1 小时)
- [ ] 数据库性能优化 (1 小时)

---

## 📖 完整文档列表

```
项目文件夹: d:\coze\

核心分析文档:
  ✅ vNext_EXECUTIVE_SUMMARY.md (本快速参考的详版)
  ✅ vNext_PRD_ANALYSIS_COMPREHENSIVE.md (完整技术方案)
  ✅ CURRENT_CODE_OPTIMIZATION_PLAN.md (代码优化路线)
  ✅ vNext_IMPLEMENTATION_GUIDE.md (项目实施指南)
  ✅ vNext_QUICK_REFERENCE.md (本文件)

原始 PRD:
  ✅ hikingSocialApp_vNext_PRD.md (基础版 PRD)
  ✅ hikingSocialApp_vNext_PRD_Lynx_AMap_QWeather.md (增强版 PRD)
```

---

**本卡片打印/保存备用。有疑问查阅详细文档或联系相关负责人。**

**预祝项目圆满成功！** 🚀

---

**版本**: v1.0
**生成时间**: 2026-01-19
**有效期**: 至项目启动 (2026-01-26)
