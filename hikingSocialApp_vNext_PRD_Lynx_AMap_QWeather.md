# 徒步社交 APP vNext 迭代 PRD（Lynx iOS/Android + 高德地图 + 和风天气）
日期：2026-01-18  
目标竞品：两步路 App（但主攻“新手轻徒步”赛道的更爽闭环）  
定位：路线前-中-后全链路的「智能准备 + 陪伴式路书 + 队伍协同 + 自动安全」户外系统

---

## 0. 战略与差异化（对标两步路）

### 0.1 我们不做什么
- 不以“海量轨迹/硬核路线库”当第一优势（两步路强项）
- 不在首发就追求复杂的专业户外数据（等 P2/P3 再做）

### 0.2 我们要打穿的“新手爽点”
1) **出发前：不焦虑**（装备/天气/风险一目了然，帮你检查）
2) **途中：不迷路**（关键点“陪伴式提醒”、偏航提示、队伍互看）
3) **安全：更安心**（失联自动提醒 + 一键 SOS + 家属/紧急联系人链路）
4) **到达后：有成就**（自动战报 + 复盘建议 + 一键分享）

### 0.3 核心差异化功能（vNext 必须做到）
- **新手智能准备助手（独特实用）**：路线+天气=>装备/补给清单 + 出发检查 + 风险提示  
- **陪伴式路书（独特体验）**：关键点到达提醒 + “下一段建议” + 打卡/拍照引导  
- **队伍协同（更爽）**：轻量位置共享（可控）+ 一键状态上报 + 领队提醒  
- **自动安全（更高级）**：失联/偏航/长时间静止 规则触发 + 救援卡片一键分享

---

## 1. 技术与集成边界（已确认）
### 1.1 端：Lynx iOS/Android
- 关键要求：定位、后台定位策略（至少“持续定位一段时间/弱后台”）、网络断线恢复
- UI：Vue3 + Tailwind 的跨端适配（交互必须“单手操作友好”）

### 1.2 地图：高德 AMap
vNext 必需能力：
- 地图展示（用户位置/路线线条/关键点）
- 路线 polyline 绘制
- POI 点标记与点击卡片
- 位置权限与定位

> 备注：路线规划（AMap 路径规划 API）可做 P1+，vNext 先以“路书+轨迹记录+偏航阈值”实现核心。

### 1.3 天气：和风天气 QWeather
vNext 必需能力（用于风险与准备清单）：
- 实况天气（温度、降水、风、体感）
- 逐小时预报（至少未来 12 小时）
- 天气预警（如有接口权限）

---

## 2. vNext 功能范围与优先级

### P0（必做上线闭环）
A. 路线/路书（Route Guide）+ 关键点 Waypoints  
B. 轨迹记录（Track）+ 路线对比偏航提醒（阈值）  
C. 新手智能准备助手（装备/补给清单 + 出发检查）  
D. 队伍协同（队伍房间 + 位置共享 + 状态上报）  
E. 安全闭环（SOS + 自动失联触发 + 救援卡片）  
F. 复盘报告（AAR）+ 分享战报卡（海报）

### P1（增强，拉开差距）
G. 天气风险雷达（基于和风：逐小时降水/风/体感）  
H. 轻量“路线故事”内容（关键点打卡串联照片）  
I. 领队工具箱（集合签到、队员掉队提醒、节奏建议）

---

## 3. P0 详细需求

## 3.1 路书与关键点（陪伴式路书：新手核心爽点）
### 目标
让新手在路上像“有人带着走”：每段路该干嘛、注意啥、到哪休息、哪里危险，都被系统主动提示。

### 用户流程
- 选路线（平台精选/活动绑定/好友分享）  
- 查看路书摘要（里程/用时/难度/天气窗口/风险点）  
- 点击“开始徒步”进入行进模式  
- 行进中按“下一关键点”推进，系统提醒与打卡  
- 结束生成复盘

### 功能点
1) 路书摘要卡（路线详情页顶部）
- 预计总时长（区间：保守/标准）  
- 里程、累计爬升（可先手动填写，后续再自动计算）  
- 难度：轻松/一般/挑战（面向新手的语义）  
- 风险概览：高温/降雨/夜行/涉水/陡坡等标签  
- “建议出发时间窗”（结合和风逐小时降水/温度阈值）

2) 关键点 Waypoints（强结构化）
- 类型：起点/集合点/观景/休息/补给/风险/撤退点/终点
- 每个关键点支持“陪伴提示”：
  - 到达提醒文案（短句）
  - 下一段建议（如：补水、注意防滑、放慢配速）
  - 推荐停留时长（新手友好）
  - 可选：一键打卡 + 拍照引导

3) 行进模式（Hike Mode）
- 展示：当前位置、路线线条、下一关键点、剩余距离（到下一个点）
- 触发：距离阈值提醒（例如 80m 以内算到达，可配置）
- “一键上报状态”入口（与队伍协同共用）

### 验收标准
- 选中路线后可进入行进模式
- 行进中能识别并提示“到达关键点”
- 关键点支持至少 6 种类型，且可配置提醒文案

---

## 3.2 轨迹记录（新手：少按钮、强可靠）
### 目标
“少操作、不丢数据”：新手只需要开始/结束，其他自动完成；断网也不影响。

### 功能点
- 开始记录：进入行进模式自动开始（默认），可手动暂停
- 本地缓存轨迹点（断网补传）
- 结束记录：生成统计 + 自动进入复盘
- 偏航提醒（规则版）：
  - 当用户与“路线 polyline/关键点走廊”距离 > 300m 且持续 3 分钟 -> 提示“可能偏航”
  - 提示操作：查看地图 / 呼叫队伍 / 一键返回上一个关键点方向（先提示，不做自动导航）

### 验收标准
- 结束后能看到：总里程、总耗时、移动时间（可先简化）、平均配速（可选）
- 偏航提醒能触发（可通过模拟位置验证）

---

## 3.3 新手智能准备助手（对标竞品的“产品化差距点”）
> 这是打败两步路的关键：两步路偏“专业工具”，但对新手的“准备焦虑”解决不够产品化。我们用强引导做壁垒。

### 目标
让新手在出发前 2 分钟完成“准备闭环”，降低劝退率。

### 功能点
1) 自动生成清单（路线+天气驱动）
- 基础必带（轻徒步通用）：水、能量补给、纸巾、充电宝、防晒、基础药品
- 天气增强：
  - 降雨概率/小时降水 > 阈值：雨衣、防水袋、防滑提醒
  - 温度低/风大：保暖层、手套、热饮建议
  - 高温：盐丸/电解质、补水频率提示
- 路线增强（按难度/时长/风险点标签）：
  - 有涉水：溯溪鞋/防水提示
  - 有夜行风险：头灯（即便轻徒步也要强调）
  - 有补给缺口：建议携带额外水量（按时长估算：例如每小时 300-500ml）

2) 出发前检查（Checklist）
- 勾选必带项（默认展开 8-12 项，避免过长）
- 通过后才允许“开始徒步”（可跳过但提示风险）
- 一键分享给队伍：“我已准备完成”状态

3) 新手安全提示卡（简短）
- “预计结束时间”“天黑时间提醒（如可获取）”“降雨窗口提醒”

### 验收标准
- 路线详情页有“准备助手”入口
- 能获取和风逐小时天气并影响清单项
- 清单可勾选保存，且生成“准备完成”状态

---

## 3.4 队伍协同（轻量但爽）
### 目标
让新手跟团不慌：看得到队友位置/状态，领队能一键提醒。

### 功能点
- 队伍房间：活动开始即创建（或进入行进模式即加入）
- 位置共享（隐私可控）：
  - 默认：仅队伍可见（新手场景更合理）
  - 开关：关闭/仅领队/全队
  - 更新频率：省电/标准（P0 两档）
- 状态上报（一个按钮，四个常用）：
  - 我OK / 需要休息 / 掉队了 / 需要帮助
- 领队提醒（广播消息模板）：
  - 集合 / 减速 / 补水 / 返程

### 验收标准
- 同一活动的队员能进入同一房间
- 能看到队员“最后更新时间”和状态
- 领队广播后所有队员即时收到（Socket.io）

---

## 3.5 安全闭环（SOS + 自动失联）
### 目标
做“真能用”的安全：即使新手不会操作，也能触发安全链路。

### 功能点
1) 一键 SOS（P0）
- 弹出确认（防误触）+ 3 秒倒计时可取消
- 触发后生成“救援卡片”：
  - 时间、位置（高德坐标）、路线名、活动名、队伍成员、紧急联系人
- 广播到队伍房间：“XX 触发 SOS”

2) 自动失联触发（P0 先做这个）
- 条件：位置共享开启 && 最后更新超过 N 分钟（默认 10 分钟）
- 行为：提醒本人（本地通知/站内提示）→ 若仍未恢复，再提醒领队/队伍

> 偏航/静止异常触发放 P1（但接口预留）

3) 紧急联系人（P0 预设）
- 用户可添加 1-3 个紧急联系人
- 首发可先做站内“联系人信息展示 + 一键复制救援卡链接/内容”
- 短信/电话外联作为 P1/P2（接口预留）

### 验收标准
- SOS 触发后队伍可见救援卡片
- 失联规则可触发并提醒领队（通过模拟超时验证）
- 阈值可在“安全设置”里调整

---

## 3.6 复盘报告 + 分享战报卡（传播增长点）
### 目标
把“到达后的爽点”做成社交货币，带来拉新。

### 功能点
- 复盘自动生成：里程/用时/配速/关键点打卡时间轴/天气摘要
- 给新手“复盘建议”（规则版）：
  - 用时过长：建议下次缩短里程或提前出发
  - 补水不足（如果中途多次点“需要休息”）：建议补水频率
- 战报卡（海报）：html2canvas 生成，可保存/分享

### 验收标准
- 结束轨迹自动生成复盘
- 一键生成海报图片并可保存到相册（Lynx 端能力需对接）

---

## 4. 数据与接口（落地建议）

### 4.1 新增核心表（建议）
- routes / route_waypoints
- tracks / track_points
- hike_reports
- team_rooms / team_location_shares / team_status_reports
- emergency_contacts / sos_events / safety_settings
- weather_snapshots（可选：缓存和风结果，减少调用）

### 4.2 外部服务封装（建议后端做代理）
- /api/v1/weather/* 由后端调用和风，前端不直接暴露 key
- 地图（高德）SDK 在端上使用，后端主要存坐标与业务数据

---

## 5. 里程碑（推荐 4 个 Sprint）

### Sprint 1（路线+路书+高德地图呈现）
- 路线详情页 + 地图 polyline + 关键点
- 行进模式基础框架（下一关键点）

### Sprint 2（轨迹记录+复盘+海报）
- 轨迹点采集/缓存/上传
- 复盘页 + 战报卡导出

### Sprint 3（准备助手+和风天气）
- 和风接入（后端代理）
- 清单生成与出发检查

### Sprint 4（队伍协同+安全）
- 队伍房间 + 位置共享 + 状态上报
- SOS + 自动失联触发 + 救援卡片

---

## 6. 上线门槛（vNext 必达）
- [ ] 新手可在 2 分钟内完成“准备检查→开始徒步”
- [ ] 行进中能收到关键点到达提醒
- [ ] 轨迹结束可生成复盘与海报
- [ ] 队伍协同可用（状态+位置更新时间）
- [ ] SOS 可用 + 自动失联提醒可用
- [ ] 隐私开关清晰且默认安全（位置共享默认可控）

---

## 7. 需要你最终拍板的产品决策（请回复选择）
1) 路线来源首发：A 平台精选为主 / B 用户创建为主 / C 支持 GPX 导入（会影响 Sprint 1 范围）
2) 位置共享默认策略：A 默认关闭 / B 默认仅队伍可见（新手团更爽但需隐私文案）
3) SOS 外联首发：A 仅站内/救援卡复制 / B 直接接短信（成本与合规不同）

---
结束