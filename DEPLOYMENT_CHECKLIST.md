# 云服务器部署检查清单

## 📋 部署前准备

### 服务器信息
- [ ] 服务器 IP 地址: ___________________
- [ ] SSH 登录用户: ___________________
- [ ] SSH 端口: _______ (默认 22)
- [ ] 服务器配置: __核__G内存__G存储

### 域名信息（如有）
- [ ] 主域名: ___________________
- [ ] API 子域名: api.___________________
- [ ] DNS 已配置 A 记录指向服务器 IP

### 账号密码
- [ ] MySQL root 密码: ___________________
- [ ] 应用数据库密码: ___________________
- [ ] JWT 密钥: ___________________

### 第三方服务（可选）
- [ ] 高德地图 Key: ___________________
- [ ] 阿里云 OSS: ___________________

---

## 🚀 部署步骤检查

### 第一步：环境安装
- [ ] 已连接到服务器
- [ ] 运行 install-server.sh
- [ ] Node.js 版本 >= 20.x
- [ ] MySQL 版本 >= 8.0
- [ ] Nginx 已安装
- [ ] PM2 已安装
- [ ] 防火墙已配置（22, 80, 443, 3000）

### 第二步：数据库初始化
- [ ] 项目代码已克隆到 /var/www/hikingSocialApp
- [ ] 运行 init-database.sh
- [ ] 数据库 hiking_app 已创建
- [ ] 用户 hiking_user 已创建并授权
- [ ] 表结构已导入（运行 init.sql）
- [ ] 可以正常连接数据库

### 第三步：配置环境变量
- [ ] 后端 .env 文件已创建
- [ ] DB_PASSWORD 已配置
- [ ] JWT_SECRET 已修改为随机字符串
- [ ] CORS_ORIGIN 已配置（域名或IP）
- [ ] 前端 .env.production 已创建
- [ ] VITE_API_BASE_URL 已配置
- [ ] VITE_WS_URL 已配置

### 第四步：部署应用
- [ ] 运行 deploy-app.sh
- [ ] 后端依赖已安装
- [ ] 后端已构建（dist 目录存在）
- [ ] PM2 进程已启动（pm2 list 显示 online）
- [ ] 前端依赖已安装
- [ ] 前端已构建（dist 目录存在）

### 第五步：配置 Nginx（如有域名）
- [ ] 复制 nginx/hiking-app.conf 到 sites-available
- [ ] 修改配置文件中的域名
- [ ] 创建软链接到 sites-enabled
- [ ] Nginx 配置测试通过（nginx -t）
- [ ] Nginx 已重启

### 第六步：SSL 证书（如有域名）
- [ ] 运行 certbot 申请证书
- [ ] 证书申请成功
- [ ] HTTPS 可以访问
- [ ] 自动续期已配置

---

## ✅ 功能测试

### 基础测试
- [ ] 后端 API 可访问
  ```bash
  curl http://localhost:3000/api/v1/health
  # 或
  curl https://api.yourdomain.com/api/v1/health
  ```
- [ ] 前端页面可访问
  - [ ] http://your-server-ip 或 https://yourdomain.com
- [ ] 页面加载正常（无白屏）

### 用户功能测试
- [ ] 注册新用户
  - [ ] 邮箱格式验证
  - [ ] 密码强度验证
  - [ ] 注册成功
- [ ] 用户登录
  - [ ] 登录成功
  - [ ] Token 正常获取
  - [ ] 页面跳转正常
- [ ] 个人资料
  - [ ] 可以查看个人资料
  - [ ] 可以编辑个人资料
  - [ ] 头像上传（如果配置了上传）

### 活动功能测试
- [ ] 发现页面
  - [ ] 活动列表加载
  - [ ] 筛选功能
  - [ ] 搜索功能
- [ ] 创建活动
  - [ ] 表单验证
  - [ ] 地图选点（如配置了高德地图）
  - [ ] 多图上传
  - [ ] 创建成功
- [ ] 活动详情
  - [ ] 详情页面加载
  - [ ] 报名功能
  - [ ] 评论功能（如有）

### 消息功能测试（如有）
- [ ] 私信功能
- [ ] 通知功能
- [ ] WebSocket 连接

---

## 📊 性能检查

### 服务状态
- [ ] Nginx 运行正常
  ```bash
  sudo systemctl status nginx
  ```
- [ ] MySQL 运行正常
  ```bash
  sudo systemctl status mysql
  ```
- [ ] 后端进程运行正常
  ```bash
  pm2 list
  ```

### 资源使用
- [ ] CPU 使用率 < 70%
- [ ] 内存使用率 < 80%
- [ ] 磁盘使用率 < 80%
- [ ] 可以通过运行 `bash scripts/health-check.sh` 检查

### 响应时间
- [ ] API 响应时间 < 500ms
- [ ] 页面加载时间 < 3s
- [ ] 静态资源加载正常

---

## 🔒 安全检查

### 服务器安全
- [ ] SSH 端口已修改（可选）
- [ ] 禁用 root SSH 登录（可选）
- [ ] 防火墙已启用
- [ ] fail2ban 已配置（可选）

### 应用安全
- [ ] 数据库密码强度足够
- [ ] JWT 密钥已修改
- [ ] CORS 配置正确
- [ ] 敏感信息未提交到 Git

### SSL/HTTPS
- [ ] SSL 证书有效
- [ ] HTTPS 强制跳转
- [ ] 安全头配置正确

---

## 📝 运维配置

### 日志管理
- [ ] 后端日志可查看（pm2 logs）
- [ ] Nginx 日志可查看
- [ ] 日志轮转已配置（可选）

### 备份配置
- [ ] 数据库备份脚本已配置
- [ ] 定时备份已设置（crontab）
- [ ] 备份文件可访问
- [ ] 恢复流程已测试

### 监控告警
- [ ] 健康检查脚本已测试
- [ ] 定时健康检查已配置（可选）
- [ ] 告警通知已配置（可选）

---

## 📚 文档检查

### 部署文档
- [ ] DEPLOYMENT_GUIDE.md 已阅读
- [ ] QUICK_DEPLOY.md 已阅读
- [ ] SCRIPTS_GUIDE.md 已阅读

### 配置记录
- [ ] 服务器信息已记录
- [ ] 账号密码已安全保存
- [ ] 配置文件已备份

---

## 🎯 后续优化（可选）

### 性能优化
- [ ] 启用 Redis 缓存
- [ ] 配置 CDN
- [ ] 数据库索引优化
- [ ] 使用 PM2 集群模式

### 功能增强
- [ ] 配置邮件服务
- [ ] 配置短信服务
- [ ] 接入支付功能
- [ ] 接入第三方登录

### 监控运维
- [ ] 配置服务器监控
- [ ] 配置应用性能监控（APM）
- [ ] 配置日志分析
- [ ] 配置自动化告警

---

## ✅ 部署完成确认

- [ ] 所有基础测试通过
- [ ] 所有功能测试通过
- [ ] 性能指标正常
- [ ] 安全配置完成
- [ ] 备份机制已建立
- [ ] 文档已归档

---

## 📞 问题反馈

如遇到问题：
1. ✅ 查看部署文档的故障排查章节
2. ✅ 运行 health-check.sh 诊断
3. ✅ 查看相关日志定位问题
4. ✅ 在 GitHub 提交 Issue

---

**检查人**: ___________________  
**检查日期**: ___________________  
**部署结果**: ✅ 成功 / ❌ 失败  
**备注**: ___________________

---

**祝部署顺利！🎉**
